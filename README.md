# Experimental tree-sitter support for Dart language

## Overview

Unlike the existing [tree-sitter-dart](https://github.com/UserNobody14/tree-sitter-dart) project,
this one is full automatically converted from the
[Dart spec grammar](https://github.com/dart-lang/sdk/blob/main/tools/spec_parser/Dart.g),
defined using [ANTLR](https://www.antlr.org/) (currenly based on v0.40, copied from
[commit](https://github.com/dart-lang/sdk/commit/e9df8dceab89790ddc55c8d0ed388fcfe8fe879f)).

This has both advantages:

 * Better coverage, in theory we should support as much Dart as the spec parser (but see Known Issues below)
 * Once the language evolves and the spec parser is updated, we could simply re-generate

and disadvatanges:

 * ANTLR is LL($\inf$), while tree-sitter is GLR, that means the grammar is structured in
   a very differnt way, and direct translation both stretches tree-sitter generation and
   results in a not very efficient parser. While efficience is not a huge problem for us
   at this point (and the generated parser is still **way** more efficient than the one
   generated by ANTLR), it seems that the "not-quite-LRish" converted grammar triggers a
   bug(?) in tree-sitter, causing a valid code to be not recognized. See Known Issues.
 * The spec parser is not really intended to have any parse tree consumers, so the grammar
   is structured in a way producing deeply nested trees even for simple syntactic constructions.
   This makes the produced parse tree not very useful for editors, since there is too much
   noise. Fortunately tree-sitter provide two ways to hide the intermediate nodes.
   Unfortuntely I don't see a way to deduce what to hide from the spec grammar automatically.
   The current plan is to have a human maintained list of visible rules.

## TODO
